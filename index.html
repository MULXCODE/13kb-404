<!DOCTYPE html><html lang="en"><head><title>13kb 404</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><style>body{background-color: #fff;margin: 0;}canvas{display: block;}#VRButton{color: blue !important;background-color: white !important;bottom: 40px !important;border-radius: 0 !important;opacity: 1 !important;}</style></head><body><script type="module">import{CylinderBufferGeometry as n,BufferAttribute as t,Mesh as e,IcosahedronBufferGeometry as o,MeshNormalMaterial as i,Group as r,MeshBasicMaterial as a,BackSide as s,MultiplyBlending as c,Float32BufferAttribute as d,BufferGeometry as u,CircleBufferGeometry as p,InstancedMesh as l,Raycaster as w,Object3D as f,Scene as g,Color as h,PerspectiveCamera as A,WebGLRenderer as y,Vector3 as m,Line as v,LineBasicMaterial as M}from"https://unpkg.com/three@0.120.1/build/three.module.js";import{VRButton as b}from"https://unpkg.com/three@0.120.1/examples/jsm/webxr/VRButton.js";var x={songData:[{i:[0,255,116,1,0,255,116,0,1,0,4,6,35,0,0,0,0,0,0,2,14,0,0,32,0,0,0,0],p:[1,1,1,1],c:[{n:[147,,,,,,147,,147,,,,,,147,,,,147,,,,,,147,,,147,,,,,135,,,,,,135,,135,,,,,,135,,,,135,,,,,,135,,,135,,,,,123,,,,,,123,,123,,,,,,123,,,,123,,,,,,123,,,123,,,,,111,,,,,,111,,111,,,,,,111,,,,111,,,,,,111,,,111],f:[]}]},{i:[3,0,128,1,3,68,128,0,1,25,4,4,40,0,0,1,55,4,0,2,67,115,124,188,67,6,39,1],p:[1,1,1,1],c:[{n:[,,,,147,,,,,,,,147,,,,,,,,147,,,,,,,,147,,,,,,,,139,,,,,,,,139,,,,,,,,139,,,,,,,,139],f:[]}]},{i:[0,192,128,0,0,192,140,18,0,0,107,115,138,3,1,0,136,5,0,2,8,92,21,32,29,5,85,8],p:[1,2,3,2],c:[{n:[151],f:[]},{n:[152],f:[]},{n:[154],f:[]}]},{i:[3,163,128,0,3,154,128,9,0,0,15,5,31,0,0,0,0,0,0,2,255,193,0,32,47,3,146,2],p:[1,1,1,1],c:[{n:[111,111,111,111,123,123,123,123,111,111,111,111,123,123,123,123,111,111,111,111,123,123,123,123,111,111,111,111,123,123,123,123],f:[]}]},{i:[2,40,128,0,3,80,128,0,0,0,5,6,58,0,0,0,195,6,0,2,64,68,0,33,164,6,121,6],p:[1,1,1,1],c:[{n:[99,,,,,,,,111,,,,,,,,99,,,,,,,,111,,,,,,,,111,,,,,,,,123,,,,,,,,111,,,,,,,,123,,,,,,,,123,,,,,,,,135,,,,,,,,123,,,,,,,,135],f:[]}]},{i:[2,100,116,1,2,99,128,3,1,0,47,47,60,124,2,0,139,4,0,3,62,160,3,32,198,4,121,5],p:[],c:[]},{i:[1,91,128,0,1,95,128,12,0,0,12,0,25,0,0,0,255,8,1,3,24,157,0,32,83,3,130,4],p:[],c:[]},{i:[0,158,128,0,1,152,116,14,0,0,11,22,11,0,0,0,69,3,1,3,88,106,0,24,77,6,31,4],p:[1,2,3,2],c:[{n:[147,,151,147,,151,147,,151,147,,151,147,,151,147,,151,147,,151,147,,151,147,,151,147,,151,147],f:[]},{n:[151,,154,151,,154,151,,154,151,,154,151,,154,151,,154,151,,154,151,,154,151,,154,151,,154,151],f:[]},{n:[154,,151,154,,151,154,,151,154,,151,154,,151,154,,151,154,,151,154,,151,154,,151,154,,151,154],f:[]}]}],rowLen:5513,patternLen:32,endPattern:3,numChannels:8},I=function(){var n,t,e,o,i,r=function(n){return Math.sin(6.283184*n)},a=function(n){return.003959503758*Math.pow(2,(n-128)/12)},s=function(n,t,e){var o,i,r,s,d,u,p,l=c[n.i[0]],w=n.i[1],f=n.i[3],g=c[n.i[4]],h=n.i[5],A=n.i[8],y=n.i[9],m=n.i[10]*n.i[10]*4,v=n.i[11]*n.i[11]*4,M=n.i[12]*n.i[12]*4,b=1/M,x=n.i[13],I=e*Math.pow(2,2-n.i[14]),z=new Int32Array(m+v+M),q=0,L=0;for(o=0,i=0;o<m+v+M;o++,i++)i>=0&&(i-=I,u=a(t+(15&(x=x>>8|(255&x)<<4))+n.i[2]-128),p=a(t+(15&x)+n.i[6]-128)*(1+8e-4*n.i[7])),r=1,o<m?r=o/m:o>=m+v&&(r-=(o-m-v)*b),s=u,f&&(s*=r*r),d=l(q+=s)*w,s=p,A&&(s*=r*r),d+=g(L+=s)*h,y&&(d+=(2*Math.random()-1)*y),z[o]=80*d*r|0;return z},c=[r,function(n){return n%1<.5?1:-1},function(n){return n%1*2-1},function(n){var t=n%1*4;return t<2?t-1:3-t}];this.init=function(r){n=r,t=r.endPattern,e=0,o=r.rowLen*r.patternLen*(t+1)*2,i=new Int32Array(o)},this.generate=function(){var a,d,u,p,l,w,f,g,h,A,y,m,v,M,b=new Int32Array(o),x=n.songData[e],I=n.rowLen,z=n.patternLen,q=0,L=0,O=!1,T=[];for(u=0;u<=t;++u)for(f=x.p[u],p=0;p<z;++p){var C=f?x.c[f-1].f[p]:0;C&&(x.i[C-1]=x.c[f-1].f[p+z]||0,C<16&&(T=[]));var R=c[x.i[15]],K=x.i[16]/512,S=Math.pow(2,x.i[17]-9)/I,W=x.i[18],k=x.i[19],G=43.23529*x.i[20]*3.141592/44100,Q=1-x.i[21]/255,j=1e-5*x.i[22],E=x.i[23]/32,P=x.i[24]/512,J=6.283184*Math.pow(2,x.i[25]-9)/I,U=x.i[26]/255,V=x.i[27]*I&-2;for(y=(u*z+p)*I,l=0;l<4;++l)if(w=f?x.c[f-1].n[p+l*z]:0){T[w]||(T[w]=s(x,w,I));var D=T[w];for(d=0,a=2*y;d<D.length;d++,a+=2)b[a]+=D[d]}for(d=0;d<I;d++)(A=b[g=2*(y+d)])||O?(m=G,W&&(m*=R(S*g)*K+.5),L+=(m=1.5*Math.sin(m))*(v=Q*(A-L)-(q+=m*L)),A=3==k?L:1==k?v:q,j&&(A=(A*=j)<1?A>-1?r(.25*A):-1:1,A/=j),O=(A*=E)*A>1e-5,M=A*(1-(h=Math.sin(J*g)*P+.5)),A*=h):M=0,g>=V&&(M+=b[g-V+1]*U,A+=b[g-V]*U),b[g]=0|M,b[g+1]=0|A,i[g]+=0|M,i[g+1]+=0|A}return++e/n.numChannels},this.createWave=function(){var n=44+2*o-8,t=n-36,e=new Uint8Array(44+2*o);e.set([82,73,70,70,255&n,n>>8&255,n>>16&255,n>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&t,t>>8&255,t>>16&255,t>>24&255]);for(var r=0,a=44;r<o;++r){var s=i[r];s=s<-32767?-32767:s>32767?32767:s,e[a++]=255&s,e[a++]=s>>8&255}return e},this.getData=function(n,t){for(var e=2*Math.floor(44100*n),o=new Array(t),r=0;r<2*t;r+=1){var a=e+r;o[r]=n>0&&a<i.length?i[a]/32768:0}return o}};function z(){const n=new I,t=new Audio;t.controls=!0,t.loop=!0;let e,o,i=!1;return{generate:async function(e){return n.init(e),new Promise((function(e,o){const i=setInterval((function(){if(!0===n.generate()>=1){clearInterval(i);const o=n.createWave(),r=new Blob([o],{type:"audio/wav"});t.src=URL.createObjectURL(r),e(t)}}),0)}))},play:function(){!0!==i&&(void 0===e&&(e=new AudioContext,o=e.createMediaElementSource(t),o.connect(e.destination)),t.play(),i=!0)},pause:function(){t.pause(),i=!1}}}const q=new Image;q.src="data:image/gif;base64,R0lGODdhAAEAAcIAAAAAAAAA//8AAAD/AP///wAAAAAAAAAAACwAAAAAAAEAAQAD/gi63P4wykmrvTjrzbv/YCiOZGmeaKqubOu+cCzPdG3feK7vfO//wKBwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+16v+CweEz+Es5oAiTNPkfa6rI8BF+3AWk7e8731B91ew5/fYUYhA1/ggyIWmhFj0ONjIuLCpNZBAJxkpuSd2+VeQuYmW5EkUCBlqB4o657rVepQrQ+oLKtoqOyVraqp8C8rLvBuJa+wbXKt3CEuq/OpSa/KgQDnLXYy9LRxZzdyCma2SzVzeWQxN7npOLjzCvtPPPCtMevevUk+/zxP/165Ir1LlHBEwFFJLSxUAcygvlCNfww0c8/dEoiwnJm/kGjvIsoKsoQaWgEyQ3hUh40qbJlyQ7X0lnDloamM5u9EOKMKW2nx5cVTmpo6fIj0XBAUYIMspSezKQThM5ouoMqVINPlxmxGiOO10tgBXJ1ujUrja94wpqtQSDAWoBvHca96m4uWXV0uRyVCnOv3bxV/bIVDBgJR0o/Wxyuy7fwizbbGNkMMLhmOZ5tu0Z1LPHhSqOeEys9ZYy0aTWi6fr9W2K1ybSoGYH9SjssZ8ZEKx99HZv26Uu/bwsfTry48ePIkytfzry58+fQo0ufTr269evYs2vfzr279+/gw4sfT768+fPo06tfz769+/fw48ufT7++/fv48+vfz7+//n8zYzEUYGXqsHaWJ6gg2ImBUynITYEQojLgWRNOVeFIF3aVIQyNGRXhJwxiGKKGI3K44WMnuhATJJFJ0qI2JaIYo4opKlajOTd6KOGMNvKIo486gvjhgzsOyVSO1iAJD5BJMrmkkcJACZeTISlZ5WrTsIRlTtRsyWVrXn5Gx04+WbbYOGR2U6aVg6TZkzTmuHkTnKCFSeUgdnbYmZ0/5lnWn3gFKiGggwr6CaGHGqqVokciumihkCYa6aOSVsrNbhTupVtumWJqoaadcvqppyKSSmJoemZw5kZsdtTIlz2i2mpQbLyIx2SbrigZGpSFqispuPpqK2a9jhoRrH0e/ivmkrLe6WovyNZZlLHTliqqtdWeeq222ZoIKrUq/SfuuOSWa+656Kar7rrstuvuu/DGK++89NZr77345qvvvvz26++/AAcs8MAEF2zwwQgnrPDCDDcMX6pXSolRgs625iBTF6uS8ZQSi1WxPx9r2bFTISs0K8gjB1YyHSeLXOTLQqJiqyozA1TzLTd7nLJcK4MAMUItm9wzRUGzPLRFR/eVNAc/d7n0aDvn0DSYTw9VtM9XE121qlkjHTUOU6O8o5/SeplsmGebLY+ccKxZMmZnuA33shSxDRmdM9WqJt7M8ln2lmkD/jeWjjbKKDCFI344XIkzvngzjUP+uFiR/lM++V2TGp654mNv662pn3suI+iji07jt9iG66vq4F5GN9DQvu50s7kyE22TaAwbLLW685pr72cUiy3wma3uemq4K4t837bczrztslNN+unTx2q69d2Wnj311weOlPHfOyz++OSXb/756Kev/vrst+/++/DHL//89Ndv//3456///vz37///AAygAAdIwAIOLGwui5kCa7GxWzRQIA+kRwRV9rUbIFBoFRTQ1g7RNaVlkEAwI9ICj7TBC1zQaCwqYUdyRg8WVsWFPPtgpmT4KRqKyIYkwqG3dCgjHp7Ohz0C4o+EGCQRGpGEBSJb8tA2ONc0kTB5M9OcVqUTvb2JqYrUsJsVs6QQLUrReVpT4vMEt0S1lZGMltJcGjm3Rsdtzo1tlNwb5RhHy83RjnXEXB4DUzk9UuqPJKye97pRu5QUMnypMyT4CLlIvnGLdYnEygn1obxJAuJV0QMZ7YR1md0Nr5O+42QiPMkt4gnvkcezJJ5it7wrbbJ1kuwgYgT5RCxyb3vYgyQqEblLRraOl6HDpQGHScxiGvOYyEymMpfJzGY685n2SQAAOw==";const L=[0,0,1,1,0,1,0,0,0,1,0,0,0,0,0,1,0,1],O=[0,1,1,0,1,0,1,1,1,1,1,0,1,1,1,0,1,0],T=[0,0,0,1,0,0,0,1,0,1,1,0,0,1,0,1,0,0],C=[0,0,1,0,1,1,1,0,1,1,1,1,1,0,1,0,1,1],R=[0,0,0,0,1,0,0,0,1,0,1,1,0,0,1,0,1,0],K=[1,0,0,1,0,1,1,1,0,1,1,1,1,1,0,1,0,1],S=new n(.5,.5,.5,5).translate(0,.25,0),W=S.attributes.position.array,k=new Float32Array(W.length);for(let n=0;n<W.length;n+=3)k[n+0]=k[n+1]=k[n+2]=W[n+1]>0?10:1;S.setAttribute("color",new t(k,3));const G=new e(new o(.25),new i);function Q(n){const t=new r,o=new e(S,new a({color:16720418,vertexColors:!0,side:s,blending:c,transparent:!0}));t.add(o);const i=new e(S,new a({color:2237183,vertexColors:!0,side:s,blending:c,transparent:!0}));t.add(i);const p=new r;t.add(p);const l=document.createElement("canvas");l.width=64,l.height=64;const w=l.getContext("2d");w.drawImage(q,64*-n,0);const f=w.getImageData(0,0,64,64).data,g=[];for(let n=0,t=0;n<f.length;n+=4,t++){const e=t%64,r=Math.floor(t/64),a=j(f,n);if(a>0&&(E(g,L,e,r),E(g,O,e,r),0===j(f,n-4)&&E(g,R,e,r),0===j(f,n+4)&&E(g,K,e,r),0===j(f,n-256)&&E(g,T,e,r),0===j(f,n+256)&&E(g,C,e,r),16711680===a&&o.position.set(e+.5,.01,r+.5),255===a&&i.position.set(e+.5,.01,r+.5),65280===a)){const n=G.clone();n.position.set(e+.5,1,r+.5),p.add(n)}}const h=new d(g,3),A=new u;A.setAttribute("position",h),A.computeVertexNormals();const y=new a,m=new e(A,y);return m.scale.y=2,t.add(m),{group:t,update:function(){for(let n=0;n<p.children.length;n++){const t=p.children[n];t.rotation.x+=.01,t.rotation.y+=.01}}}}function j(n,t){return n[t+0]<<16|n[t+1]<<8|n[t+2]}function E(n,t,e,o){for(let i=0;i<18;i+=3)n.push(t[i+0]+e,t[i+1],t[i+2]+o)}const P=new p(.2,5).translate(0,0,.01),J=new a({color:16711680}),U=new l(P,J,1e3);U.count=0;const V=new r,D=new function(){let n=0;return{mesh:U,add:function(t){U.setMatrixAt(n++,t),U.instanceMatrix.needsUpdate=!0,n>1e3&&(n=0),U.count<n&&(U.count=n),0===n&&console.log(U)},reset:function(){U.count=0,n=0}}};V.add(D.mesh);const Y=new w,Z=new f;function B(){let n;return{setMap:function(t){n=t},group:V,shoot:function(t){Y.ray.origin.setFromMatrixPosition(t.matrixWorld),Y.ray.direction.set(0,0,-1).applyQuaternion(t.quaternion).applyQuaternion(t.parent.quaternion);const e=Y.intersectObject(n.group.children[3]);if(e.length>0){const n=e[0];Z.position.set(0,0,0),Z.lookAt(n.face.normal),Z.position.copy(n.point),Z.updateMatrix(),console.log(Z.quaternion.toArray()),D.add(Z.matrix)}}}}let N,F,H,X,$,_,nn,tn,en,on,rn,an,sn=1,cn=!0;function dn(n){void 0!==tn&&F.remove(tn.group),!0===cn&&(n=0),tn=new Q(n),F.add(tn.group);const t=tn.group.children;if(en=t[0],on=t[1],rn=t[2],!0===cn){const n=tn.group.children[3];n.scale.y=.5,n.geometry.center();const t=n.clone();t.material=new a({color:187}),t.position.y=-2,tn.group.add(t),en.visible=!1,on.position.set(0,-3,0),on.scale.setScalar(70)}X.position.copy(en.position),an.setMap(tn)}function un(){N.aspect=window.innerWidth/window.innerHeight,N.updateProjectionMatrix(),H.setSize(window.innerWidth,window.innerHeight)}function pn(n){let t=n.target;if(t.userData.gamepad=n.data.gamepad,t.userData.handedness=n.data.handedness,"right"===n.data.handedness){let n=new u;n.setFromPoints([new m(0,0,0),new m(0,0,-1)]);let e=new v(n,new M({color:255}));e.scale.z=2,t.add(e)}}function ln(n){const t=n.userData.gamepad;switch(n.userData.handedness){case"left":X.rotateY(.03*-t.axes[2]);const e=.03*t.axes[3],o=Math.sin(e);nn.ray.origin.copy(X.position),nn.ray.direction.set(0,0,o).applyQuaternion(X.quaternion);const i=nn.intersectObject(tn.group.children[3]);if(i.length>0){i[0].distance-1>e&&X.translateZ(e)}break;case"right":t.buttons[0].pressed&&an.shoot(n)}}function wn(){if(!0===cn){const n=performance.now()/5e3;tn.group.rotation.x=Math.sin(n)/4,tn.group.rotation.y=Math.PI,tn.group.rotation.z=Math.cos(1.1234*n)/4,N.position.y=50,N.position.z=2,N.rotation.x=-Math.PI/2}else ln($),ln(_),X.position.distanceTo(on.position)<1&&dn(++sn),tn.update();H.render(F,N)}!async function(){F=new g,F.background=new h(16777215),X=new r,X.rotation.y=Math.PI,F.add(X),N=new A(70,window.innerWidth/window.innerHeight,.1,100),N.position.set(0,1.6,0),X.add(N);const n=new z;await n.generate(x),an=new B,F.add(an.group),dn(sn),H=new y({antialias:!0}),H.setAnimationLoop(wn),H.setPixelRatio(window.devicePixelRatio),H.setSize(window.innerWidth,window.innerHeight),H.xr.enabled=!0,H.xr.addEventListener("sessionstart",(function(){cn=!1,dn(sn),n.play()})),H.xr.addEventListener("sessionend",(function(){cn=!0,dn(sn),n.pause()})),document.body.appendChild(H.domElement),document.body.appendChild(b.createButton(H)),window.addEventListener("resize",un,!1),$=H.xr.getController(0),$.addEventListener("connected",pn),X.add($),_=H.xr.getController(1),_.addEventListener("connected",pn),X.add(_),nn=new w}();</script></body></html>
