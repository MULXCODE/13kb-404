<!DOCTYPE html><html lang="en"><head><title>13kb 404</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><style>body{background-color: #fff;margin: 0;}canvas{display: block;}#VRButton{color: blue !important;background-color: white !important;bottom: 40px !important;border-radius: 0 !important;opacity: 1 !important;}</style></head><body><script type="module">import{CylinderBufferGeometry as n,BufferAttribute as e,Mesh as t,IcosahedronBufferGeometry as o,MeshNormalMaterial as i,Group as r,MeshBasicMaterial as a,BackSide as s,MultiplyBlending as c,Float32BufferAttribute as d,BufferGeometry as u,CircleBufferGeometry as p,InstancedMesh as l,Raycaster as w,Object3D as f,Scene as h,Color as g,PerspectiveCamera as A,WebGLRenderer as y,Vector3 as v,Line as m,LineBasicMaterial as b}from"https://unpkg.com/three@0.120.1/build/three.module.js";import{VRButton as x}from"https://unpkg.com/three@0.120.1/examples/jsm/webxr/VRButton.js";var z={songData:[{i:[0,255,116,1,0,255,116,0,1,0,4,6,35,0,0,0,0,0,0,2,14,0,0,32,0,0,0,0],p:[1,1,1,1],c:[{n:[147,,,,,,147,,147,,,,,,147,,,,147,,,,,,147,,,147,,,,,135,,,,,,135,,135,,,,,,135,,,,135,,,,,,135,,,135,,,,,123,,,,,,123,,123,,,,,,123,,,,123,,,,,,123,,,123,,,,,111,,,,,,111,,111,,,,,,111,,,,111,,,,,,111,,,111],f:[]}]},{i:[3,0,128,1,3,68,128,0,1,25,4,4,40,0,0,1,55,4,0,2,67,115,124,188,67,6,39,1],p:[1,1,1,1],c:[{n:[,,,,147,,,,,,,,147,,,,,,,,147,,,,,,,,147,,,,,,,,139,,,,,,,,139,,,,,,,,139,,,,,,,,139],f:[]}]},{i:[0,192,128,0,0,192,140,18,0,0,107,115,138,3,1,0,136,5,0,2,8,92,21,32,29,5,85,8],p:[1,2,3,2],c:[{n:[151],f:[]},{n:[152],f:[]},{n:[154],f:[]}]},{i:[3,163,128,0,3,154,128,9,0,0,15,5,31,0,0,0,0,0,0,2,255,193,0,32,47,3,146,2],p:[1,1,1,1],c:[{n:[111,111,111,111,123,123,123,123,111,111,111,111,123,123,123,123,111,111,111,111,123,123,123,123,111,111,111,111,123,123,123,123],f:[]}]},{i:[2,40,128,0,3,80,128,0,0,0,5,6,58,0,0,0,195,6,0,2,64,68,0,33,164,6,121,6],p:[1,1,1,1],c:[{n:[99,,,,,,,,111,,,,,,,,99,,,,,,,,111,,,,,,,,111,,,,,,,,123,,,,,,,,111,,,,,,,,123,,,,,,,,123,,,,,,,,135,,,,,,,,123,,,,,,,,135],f:[]}]},{i:[2,100,116,1,2,99,128,3,1,0,47,47,60,124,2,0,139,4,0,3,62,160,3,32,198,4,121,5],p:[],c:[]},{i:[1,91,128,0,1,95,128,12,0,0,12,0,25,0,0,0,255,8,1,3,24,157,0,32,83,3,130,4],p:[],c:[]},{i:[0,158,128,0,1,152,116,14,0,0,11,22,11,0,0,0,69,3,1,3,88,106,0,24,77,6,31,4],p:[1,2,3,2],c:[{n:[147,,151,147,,151,147,,151,147,,151,147,,151,147,,151,147,,151,147,,151,147,,151,147,,151,147],f:[]},{n:[151,,154,151,,154,151,,154,151,,154,151,,154,151,,154,151,,154,151,,154,151,,154,151,,154,151],f:[]},{n:[154,,151,154,,151,154,,151,154,,151,154,,151,154,,151,154,,151,154,,151,154,,151,154,,151,154],f:[]}]}],rowLen:5513,patternLen:32,endPattern:3,numChannels:8},M=function(){var n,e,t,o,i,r=function(n){return Math.sin(6.283184*n)},a=function(n){return.003959503758*Math.pow(2,(n-128)/12)},s=function(n,e,t){var o,i,r,s,d,u,p,l=c[n.i[0]],w=n.i[1],f=n.i[3],h=c[n.i[4]],g=n.i[5],A=n.i[8],y=n.i[9],v=n.i[10]*n.i[10]*4,m=n.i[11]*n.i[11]*4,b=n.i[12]*n.i[12]*4,x=1/b,z=n.i[13],M=t*Math.pow(2,2-n.i[14]),j=new Int32Array(v+m+b),Y=0,q=0;for(o=0,i=0;o<v+m+b;o++,i++)i>=0&&(i-=M,u=a(e+(15&(z=z>>8|(255&z)<<4))+n.i[2]-128),p=a(e+(15&z)+n.i[6]-128)*(1+8e-4*n.i[7])),r=1,o<v?r=o/v:o>=v+m&&(r-=(o-v-m)*x),s=u,f&&(s*=r*r),d=l(Y+=s)*w,s=p,A&&(s*=r*r),d+=h(q+=s)*g,y&&(d+=(2*Math.random()-1)*y),j[o]=80*d*r|0;return j},c=[r,function(n){return n%1<.5?1:-1},function(n){return n%1*2-1},function(n){var e=n%1*4;return e<2?e-1:3-e}];this.init=function(r){n=r,e=r.endPattern,t=0,o=r.rowLen*r.patternLen*(e+1)*2,i=new Int32Array(o)},this.generate=function(){var a,d,u,p,l,w,f,h,g,A,y,v,m,b,x=new Int32Array(o),z=n.songData[t],M=n.rowLen,j=n.patternLen,Y=0,q=0,C=!1,I=[];for(u=0;u<=e;++u)for(f=z.p[u],p=0;p<j;++p){var L=f?z.c[f-1].f[p]:0;L&&(z.i[L-1]=z.c[f-1].f[p+j]||0,L<16&&(I=[]));var O=c[z.i[15]],G=z.i[16]/512,K=Math.pow(2,z.i[17]-9)/M,Q=z.i[18],R=z.i[19],E=43.23529*z.i[20]*3.141592/44100,W=1-z.i[21]/255,k=1e-5*z.i[22],D=z.i[23]/32,P=z.i[24]/512,T=6.283184*Math.pow(2,z.i[25]-9)/M,H=z.i[26]/255,U=z.i[27]*M&-2;for(y=(u*j+p)*M,l=0;l<4;++l)if(w=f?z.c[f-1].n[p+l*j]:0){I[w]||(I[w]=s(z,w,M));var X=I[w];for(d=0,a=2*y;d<X.length;d++,a+=2)x[a]+=X[d]}for(d=0;d<M;d++)(A=x[h=2*(y+d)])||C?(v=E,Q&&(v*=O(K*h)*G+.5),q+=(v=1.5*Math.sin(v))*(m=W*(A-q)-(Y+=v*q)),A=3==R?q:1==R?m:Y,k&&(A=(A*=k)<1?A>-1?r(.25*A):-1:1,A/=k),C=(A*=D)*A>1e-5,b=A*(1-(g=Math.sin(T*h)*P+.5)),A*=g):b=0,h>=U&&(b+=x[h-U+1]*H,A+=x[h-U]*H),x[h]=0|b,x[h+1]=0|A,i[h]+=0|b,i[h+1]+=0|A}return++t/n.numChannels},this.createWave=function(){var n=44+2*o-8,e=n-36,t=new Uint8Array(44+2*o);t.set([82,73,70,70,255&n,n>>8&255,n>>16&255,n>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&e,e>>8&255,e>>16&255,e>>24&255]);for(var r=0,a=44;r<o;++r){var s=i[r];s=s<-32767?-32767:s>32767?32767:s,t[a++]=255&s,t[a++]=s>>8&255}return t},this.getData=function(n,e){for(var t=2*Math.floor(44100*n),o=new Array(e),r=0;r<2*e;r+=1){var a=t+r;o[r]=n>0&&a<i.length?i[a]/32768:0}return o}};function j(){const n=new M,e=new Audio;e.controls=!0,e.loop=!0;let t,o,i=!1;return{generate:async function(t){return n.init(t),new Promise((function(t,o){const i=setInterval((function(){if(!0===n.generate()>=1){clearInterval(i);const o=n.createWave(),r=new Blob([o],{type:"audio/wav"});e.src=URL.createObjectURL(r),t(e)}}),0)}))},play:function(){!0!==i&&(void 0===t&&(t=new AudioContext,o=t.createMediaElementSource(e),o.connect(t.destination)),e.play(),i=!0)},pause:function(){e.pause(),i=!1}}}const Y=new Image;Y.src="data:image/gif;base64,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";const q=[0,0,1,1,0,1,0,0,0,1,0,0,0,0,0,1,0,1],C=[0,1,1,0,1,0,1,1,1,1,1,0,1,1,1,0,1,0],I=[0,0,0,1,0,0,0,1,0,1,1,0,0,1,0,1,0,0],L=[0,0,1,0,1,1,1,0,1,1,1,1,1,0,1,0,1,1],O=[0,0,0,0,1,0,0,0,1,0,1,1,0,0,1,0,1,0],G=[1,0,0,1,0,1,1,1,0,1,1,1,1,1,0,1,0,1],K=new n(.5,.5,.5,5).translate(0,.25,0),Q=K.attributes.position.array,R=new Float32Array(Q.length);for(let n=0;n<Q.length;n+=3)R[n+0]=R[n+1]=R[n+2]=Q[n+1]>0?10:1;K.setAttribute("color",new e(R,3));const E=new t(new o(.25),new i);function W(n){const e=new r,o=new t(K,new a({color:16720418,vertexColors:!0,side:s,blending:c,transparent:!0}));e.add(o);const i=new t(K,new a({color:2237183,vertexColors:!0,side:s,blending:c,transparent:!0}));e.add(i);const p=new r;e.add(p);const l=document.createElement("canvas");l.width=64,l.height=64;const w=n%4,f=Math.floor(n/4),h=l.getContext("2d");h.drawImage(Y,64*-w,64*-f);const g=h.getImageData(0,0,64,64).data,A=[];for(let n=0,e=0;n<g.length;n+=4,e++){const t=e%64,r=Math.floor(e/64),a=k(g,n);if(a>0&&(D(A,q,t,r),D(A,C,t,r),0===k(g,n-4)&&D(A,O,t,r),0===k(g,n+4)&&D(A,G,t,r),0===k(g,n-256)&&D(A,I,t,r),0===k(g,n+256)&&D(A,L,t,r),16711680===a&&o.position.set(t+.5,.01,r+.5),255===a&&i.position.set(t+.5,.01,r+.5),65280===a)){const n=E.clone();n.position.set(t+.5,1,r+.5),p.add(n)}}const y=new d(A,3),v=new u;v.setAttribute("position",y),v.computeVertexNormals();const m=new a,b=new t(v,m);return b.scale.y=2,e.add(b),{group:e,update:function(){for(let n=0;n<p.children.length;n++){const e=p.children[n];e.rotation.x+=.01,e.rotation.y+=.01}o.rotation.y+=.02,i.rotation.y+=.02}}}function k(n,e){return n[e+0]<<16|n[e+1]<<8|n[e+2]}function D(n,e,t,o){for(let i=0;i<18;i+=3)n.push(e[i+0]+t,e[i+1],e[i+2]+o)}const P=new p(.2,5).translate(0,0,.01),T=new a({color:16711680}),H=new l(P,T,1e3);H.count=0;const U=new r,X=new function(){let n=0;return{mesh:H,add:function(e){H.setMatrixAt(n++,e),H.instanceMatrix.needsUpdate=!0,n>1e3&&(n=0),H.count<n&&(H.count=n),0===n&&console.log(H)},reset:function(){H.count=0,n=0}}};U.add(X.mesh);const B=new w,S=new f;function V(){let n;return{setMap:function(e){n=e},group:U,shoot:function(e){B.ray.origin.setFromMatrixPosition(e.matrixWorld),B.ray.direction.set(0,0,-1).applyQuaternion(e.quaternion).applyQuaternion(e.parent.quaternion);const t=B.intersectObject(n.group.children[3]);if(t.length>0){const n=t[0];S.position.set(0,0,0),S.lookAt(n.face.normal),S.position.copy(n.point),S.updateMatrix(),console.log(S.quaternion.toArray()),X.add(S.matrix)}}}}let F,J,Z,N,$,_,nn,en,tn,on,rn,an,sn=1,cn=!0;function dn(n){void 0!==en&&J.remove(en.group),!0===cn&&(n=0),en=new W(n),J.add(en.group);const e=en.group.children;if(tn=e[0],on=e[1],rn=e[2],!0===cn){const n=en.group.children[3];n.scale.y=.5,n.geometry.center();const e=n.clone();e.material=new a({color:187}),e.position.y=-2,en.group.add(e),tn.visible=!1,on.position.set(0,-3,0),on.scale.setScalar(70)}N.position.copy(tn.position),an.setMap(en)}function un(){F.aspect=window.innerWidth/window.innerHeight,F.updateProjectionMatrix(),Z.setSize(window.innerWidth,window.innerHeight)}function pn(n){let e=n.target;if(e.userData.gamepad=n.data.gamepad,e.userData.handedness=n.data.handedness,"right"===n.data.handedness){let n=new u;n.setFromPoints([new v(0,0,0),new v(0,0,-1)]);let t=new m(n,new b({color:255}));t.scale.z=2,e.add(t)}}function ln(n){const e=n.userData.gamepad;switch(n.userData.handedness){case"left":N.rotateY(.03*-e.axes[2]);const t=.03*e.axes[3],o=Math.sin(t);nn.ray.origin.copy(N.position),nn.ray.direction.set(0,0,o).applyQuaternion(N.quaternion);const i=nn.intersectObject(en.group.children[3]);if(i.length>0){i[0].distance-1>t&&N.translateZ(t)}break;case"right":e.buttons[0].pressed&&an.shoot(n)}}function wn(){if(!0===cn){const n=performance.now()/5e3;en.group.rotation.x=Math.sin(n)/4,en.group.rotation.y=Math.PI,en.group.rotation.z=Math.cos(1.1234*n)/4,F.position.y=50,F.position.z=2,F.rotation.x=-Math.PI/2}else ln($),ln(_),N.position.distanceTo(on.position)<1&&dn(++sn),en.update();Z.render(J,F)}!async function(){J=new h,J.background=new g(16777215),N=new r,N.rotation.y=Math.PI,J.add(N),F=new A(70,window.innerWidth/window.innerHeight,.1,100),F.position.set(0,1.6,0),N.add(F);const n=new j;await n.generate(z),an=new V,J.add(an.group),dn(sn),Z=new y({antialias:!0}),Z.setAnimationLoop(wn),Z.setPixelRatio(window.devicePixelRatio),Z.setSize(window.innerWidth,window.innerHeight),Z.xr.enabled=!0,Z.xr.addEventListener("sessionstart",(function(){cn=!1,dn(sn),n.play()})),Z.xr.addEventListener("sessionend",(function(){cn=!0,dn(sn),n.pause()})),document.body.appendChild(Z.domElement),document.body.appendChild(x.createButton(Z)),window.addEventListener("resize",un,!1),$=Z.xr.getController(0),$.addEventListener("connected",pn),N.add($),_=Z.xr.getController(1),_.addEventListener("connected",pn),N.add(_),nn=new w}();</script></body></html>
